#第二章 一切都是对象

​	Java和C++都是一种杂合语言，但在Java中，设计者觉得这种杂合并不像在C++里显得那么重要。杂合语言允许采用多种编程风格；之所以说C++是一种杂合语言，是因为它支持与C语言的向后兼容能力。由于C++是C的一个超集，所以包含的许多特性是C语言所不具备的，这些特性使C++某些地方显得过于复杂。
##2.1 用句柄操纵对象

​	尽管把一切都看成对象，Java中操纵的标识符实际上是指向一个对象的句柄（Handle，有些地方称之为“引用”甚至是“指针”）。
​	句柄可以独立存在，String s;实际上只创建了一个句柄，没有与任何对象连接，对它发消息会报错。因此，一种更安全的做法是：创建一个句柄时，无论如何都要对其初始化。

##2.2 所有类型都必须创建

###2.2.1 保存到什么地方

​	有六个地方可以保存数据：

1. 寄存器
   位于CPU中，速度最快，数量有限，由编译器控制。
2. 堆栈
   位于RAM中，使用堆栈指针访问，指针向上释放内存，向下创建新的内存，Java编译器必须准确知道所有数据的“长度”和“存在时间”，因为它必须生成响应的代码，控制指针上下移动。这一限制影响了程序的灵活性，所以仅有句柄会被保存在堆栈中，对象本身不放到其中。
3. 堆
   一种常规用途的内存池，保存着Java的对象。Java不必知道数据需要分配的存储空间和停留时间。
   使用new关键字创建对象时，Java编译器会把这些对象存储在堆中。
   灵活性带来的是分配存储时间会更加耗时。
4. 静态存储
   静态指的是位于固定位置（也在RAM中）。静态数据在程序运行期间将随时等候调用。对象中的某些元素可由static关键字指定为静态的。但是Java对象本身永远不会被置入静态存储空间。
5. 常数存储
   常数值通常直接存储在程序代码内部，因为它们永远不会改变。有的常数需要严格保护，所以可以考虑置入只读存储器（ROM）。
6. RAM之外
   数据独立于程序之外、程序不运行时仍可存在、在程序的控制范围之外。
   两个主要的例子：“流式对象”和“固定对象”。
   对于前者，对象会变成字节流，通常会发给另一台机器。
   对于后者，对象保存在磁盘中。
   程序停止运行时，他们也可以保持自己的状态不变，如有需要，可将它们恢复成普通的机遇RAM的对象。

###2.2.2 特殊情况：主要类型
​	这类数据需要经常使用到，所以不用new关键字创建对象，因为new创建的对象放在堆里，Java和C与C++一样，对它们创建一个非句柄的“自动”变量，变量中存储了数据的值，并直接存储在堆栈中，便于高效存取。
Java定义了每种主要类型的大小，且不随着机器结构的变化而变化，这是Java平台无关性的原因之一。

| 主类型     |  大小  |    最小值    |      最大值       |     封装器类型 |
| ------- | :--: | :-------: | :------------: | --------: |
| boolean |  1位  |     -     |       -        |   Boolean |
| char    | 16位  | Unicode 0 | Unicode 2^16-1 | Character |
| byte    |  8位  |   -128    |      127       |      Byte |
| short   | 16位  |   -2^15   |     2^15-1     |     Short |
| int     | 32位  |   -2^31   |     2^31-1     |   Integer |
| long    | 64位  |   -2^63   |     2^63-1     |      Long |
| float   | 32位  |  IEEE754  |    IEEE754     |     Float |
| double  | 64位  |  IEEE754  |    IEEE754     |    Double |
| Void    |  -   |     -     |       -        |      Void |

​	数值类型全都是有符号的，主数据类型都有自己的封装器类型，如果想让一个堆内的一个非主要对象表示主类型，就要使用对应的封装器。
​	例：

```java
char c = 'x';
Character C = new Character(c);
```

​	或者是

```java
Character C = new Character('x');
```

​	

1. 高精度数字
   Java中增加了两个类用于高精度计算，它们是BigInteger和BigDecimal，用法类似于封装类，不同的是，它们指没有对应的主类型。
   BigInteger可以表示任意精度的整数，BigDecimal可以表示任意精度的定点数字，常用于计算货币。基本数据类能做的事情，它们也都能做，但是不能使用运算符，只能使用本身的方法。
   计算起来速度会比较慢，但是运算速度的降低带来的是精度的提升。

### 2.2.3 Java的数组

​	在C或者C++中使用数组的危险性在于数组仅仅是一个内存块，如果访问超出内存块的范围或者在未初始化的时候访问内存块，会产生不可预料的错误。
Java数组可以保证被初始化，Java中建立数组时，实际上是建立了一个句柄数组，每个句柄都会被初始化，且带有一个null，当编译器看到null，就知道这个句柄还没有指向一个对象，所有的句柄都需要被初始化。
也可以创建主类型数组，初始化为0。

​	

